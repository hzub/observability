<div class="slides">
        <section data-background="#d57b7b">
          <section>
            <p>Cz I</p>
            <p><strong>Bdy</strong></p>
          </section>
          <section>
            <p>Potrzebujemy?</p>
            <aside class="notes">
              <li>Gadamy o tym czy nie gadamy, macie bezbdne aplikacje?</li>
              <li>
                Zakadamy 偶e mamy super CI wic 偶adne bdy czasu budowy:
                syntaxy etc. nie przejd wic interesuj nas tylko runtimey
              </li>
            </aside>
          </section>
        </section>
        <section data-background="#d57b7b">
          <section>
            <p>To co robimy z tymi bdami </p>
            <ul>
              <li class="fragment">#1: Nic</li>
              <li class="fragment">#2: adny modal + wylij prosz email</li>
              <li class="fragment">
                <strong>#3: adny modal + automatyzacja</strong>
              </li>
            </ul>
            <aside class="notes">
              <li>BANA</li>
              <li>1: nic nie robimy</li>
              <li>2: wywietlamy adny modal + email</li>
              <li>3: automatyzujemy</li>
            </aside>
          </section>
        </section>
        <section data-background="#d57b7b">
          <section>
            <p>Raportujemy bdy</p>
            <ul>
              <li class="fragment">
                Z pomoc narzdzi: Sentry, LogRocket etc.
              </li>
              <li class="fragment">
                Po swojemu: wasny system do raportowania
              </li>
            </ul>
            <p class="fragment">
              Cel: statystyka, reprodukcja, zaraportowanie, naprawa
            </p>
            <aside class="notes">
              <li>BANA</li>
              <li>mo偶e tak</li>
              <li>a moze tak</li>
            </aside>
          </section>
          <section>[OBRAZEK] flow jak idzie bd</section>
        </section>
        <section data-background="#d57b7b">
          <p>Puapki i praktyki</p>
        </section>
        <section data-background="#d57b7b">
          <section>
            <p>Puapka #1</p>
            <p><strong>Logujemy za mao</strong></p>
            <aside class="notes">
              <li>BANA</li>
              <li>klasyk</li>
            </aside>
          </section>
          <section>
            <pre><code data-line-numbers="1-11|13-21|23-27|5-7|18-20" data-trim>class ApiService {
	async call() {
		const response = await fetch("...");
		if (!response.ok) {
			return Promise.reject(new Error(
        "Failed to fetch [URL]"
      ));
		}
		return response.json();
	}
}

function process() {
	new ApiService().call()
	  .then((data) => {
		  // ...
	  })
	  .catch((error) => {
		  // ?
	  });
}

document
	.querySelector("button")
	.addEventListener("click", () => {
		process();
	});
  </code></pre>
          </section>
          <section>
            <pre><code data-trim>
              .catch((error) => {
                console.log(error);
              });
			  </code></pre>
          </section>
          <section>
            <img src="img/bledy/1.png" width="100%"" />
            <p class="fragment">Z grubsza wszystko co wiemy 锔</p>
            <p class="fragment">Jaki ticket z tego wyjdzie?</p>
          </section>
          <section>
            <p>Co pomo偶e (atwe)?</p>
            <ul>
              <li class="fragment">
                Peny stack trace
                <ul>
                  <li>(za chwil)</li>
                </ul>
              </li>

              <li class="fragment">URL / historia URLi (route-贸w)</li>

              <li class="fragment"><code>navigator.*</code></li>
            </ul>
          </section>
          <section>
            <p>Co jeszcze pomo偶e?</p>
            <ul>
              <li class="fragment">odbitka feature flag</li>
              <li class="fragment">ewaluacja A/B</li>
            </ul>
          </section>
        </section>
        <section data-background="#d57b7b">
          <section>
            <p>Puapka #2</p>
            <p><strong>Logujemy za du偶o</strong></p>
            <aside class="notes">
              <li>mo偶na?</li>
            </aside>
          </section>
          <section>
            <img src="img/bledy/2.png" />
            <p class="fragment">Co tu jest nie tak?</p>
          </section>
          <section>
            <p class="fragment">Konstruujc bdy, raporty, logi:</p>
            <ul>
              <li class="fragment">
                Unikajmy treci tworzonych przez u偶ytkownik贸w
              </li>
              <li class="fragment">Najlepiej bazowa na URLach</li>
            </ul>
          </section>
        </section>
        <section data-background="#d57b7b">
          <section>
            <p>Puapka #3</p>
            <p><strong>Niekompletne stack trace'y</strong></p>
            <aside class="notes"></aside>
          </section>
          <section>
            <pre><code data-line-numbers="1-11|13-21|23-27|5-7|18-20" data-trim>class ApiService {
  async call() {
    const response = await fetch("...");
    if (!response.ok) {
      return Promise.reject(new Error(
        "Failed to fetch [URL]"
      ));
    }
    return response.json();
  }
}

function process() {
  new ApiService().call()
    .then((data) => {
      // ...
    })
    .catch((error) => {
      console.log(error.stack)
    });
}</code></pre>
          </section>
          <section><img src="img/bledy/1.png" width="100%" /></section>
          <section>
            <pre><code data-line-numbers="2|3-6" data-trim>function process() {
  const initiatorStack = new Error().stack;
  new ApiService().call().catch((error) => {
    console.log(error.stack);
    console.log(initiatorStack);
  });
}

document.querySelector("button").addEventListener("click", () => {
  process();
});
</code></pre>
          </section>
          <section><img src="img/bledy/3.png" /></section>
          <section>
            <pre><code data-line-numbers="4-8" data-trim>function process() {
  const initiatorStack = new Error().stack;
  new ApiService().call().catch((error) => {
    const completeStack = [
      error.stack,
      ...initiatorStack.split("\n").slice(1),
    ].join("\n");
    console.log(completeStack);
  });
}</code></pre>
          </section>
          <section><img src="img/bledy/4.png" /></section>
        </section>
        <section data-background="#d57b7b">
          <section>
            <p>Puapka #4</p>
            <p><strong>Brak informacji od u偶ytkownika</strong></p>
            <aside class="notes">
              <li>Pod spodem adnie wysya si bd</li>
              <li>A na wierzchu?</li>
            </aside>
          </section>
          <section><img src="img/bledy/5.png" width="100%" /></section>
          <section><img src="img/bledy/6.png" width="100%" /></section>
          <section>
            <p>Czy mo偶na lepiej?</p>
            <p class="fragment">A zrzut ekranu? </p>
          </section>
          <section>
            <pre><code data-trim data-line-numbers="|2-6|8-12|14-21">async function snapshot() {
  const stream = await navigator.mediaDevices
    .getDisplayMedia({
      preferCurrentTab: true,
    });
  const [track] = stream.getVideoTracks();

  const canvas = document.createElement("canvas");
  const video = document.createElement("video");
  video.srcObject = stream;

  await video.play();

  canvas.width = video.videoWidth;
  canvas.height = video.videoHeight;
  canvas.getContext("2d").drawImage(video, 0, 0);

  canvas.toBlob((blob) => {
    track.stop();
    // Przetworzenie + wysanie bloba
  });
}
</code></pre>
          </section>
          <section><img src="img/bledy/7.png" width="100%" /></section>
          <section>Z autopsji: 锔 mocno pomogo lokalizowa bdy</section>
        </section>
        <section data-background="#d57b7b">
          <section>
            <p>Puapka #5</p>
            <p><strong>Testowanie raportowania</strong></p>
            <aside class="notes">
              <li>odpalacie system, stawiacie sentry czy co tam</li>
              <li>i nie ma bd贸w</li>
              <li>...i nie ma bd贸w</li>
              <li>to dobrze, prawda?</li>
              <li>warto napisa test kt贸ry zmockowane</li>
              <li>
                a bardziej warto napisa e2e kt贸ry bdzie siedzia w waszym CI i
                raz na miesic faktycznie wysypie stron i zgosi faktyczny
                raport
              </li>
            </aside>
          </section>
        </section>
        <section data-background="#d57b7b">
          <section>
            <p>Puapka #6</p>
            <p><strong>Niesp贸jny system logowania</strong></p>
            <aside class="notes"></aside>
          </section>
          <section>
            <pre><code data-trim data-line-numbers="1-13|15-18|20-23|25-30">
class ErrorWrapper extends Error {
  constructor(
    private error: string,
    private errorCode: number,
    private stackTrace = new Error().stack
  ) {
    super(error);
  }
  serialize() {
    const { error, stackTrace, errorCode } = this;
    return { error, stackTrace, errorCode };
  }
}

function doSomething1() {
  // ...
  throw new ErrorWrapper("Unauthorized", 401);
}

function doSomething2() {
  // ...
  throw { code: 401, message: "Unauthorized" };
}

function doSomething3() {
  // ...
  throw new Error(JSON.stringify(
    { code: 401, message: "Unauthorized" }
  ));
}

            </code></pre>
          </section>
          <section>く</section>
        </section>
      </div>